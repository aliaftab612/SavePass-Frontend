<section>
  <div
    class="flex flex-col items-center justify-center gap-5 pb-10 sm:px-6 sm:pb-16 lg:px-8 lg:pb-24"
  >
    <div class="flex w-3/4 flex-col justify-center gap-3">
      <h2
        class="flex items-center text-2xl font-bold leading-tight dark:text-white"
      >
        <svg
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          class="h-12 w-12"
          x="0px"
          y="0px"
          viewBox="0 0 216 216"
          style="enable-background: new 0 0 216 216"
          xml:space="preserve"
        >
          <style type="text/css">
            .st0 {
              fill: none;
            }
            .st1 {
              fill-rule: evenodd;
              clip-rule: evenodd;
              fill: #353535;
            }
            .st2 {
              fill-rule: evenodd;
              clip-rule: evenodd;
            }
            .st3 {
              fill: #141313;
            }
          </style>
          <g id="Layer_1"></g>
          <g id="Isolation_Mode">
            <rect class="st0" width="216" height="216" />
            <g>
              <g>
                <path
                  class="st1 dark:fill-white"
                  d="M172.32,96.79c0,13.78-8.48,25.5-20.29,29.78l7.14,11.83l-10.57,13l10.57,12.71l-17.04,22.87l-12.01-12.82
           v-25.9v-22.56c-10.68-4.85-18.15-15.97-18.15-28.91c0-17.4,13.51-31.51,30.18-31.51C158.81,65.28,172.32,79.39,172.32,96.79z
            M142.14,101.61c4.02,0,7.28-3.4,7.28-7.6c0-4.2-3.26-7.61-7.28-7.61s-7.28,3.4-7.28,7.61
           C134.85,98.21,138.12,101.61,142.14,101.61z"
                />
                <path
                  class="st2 dark:fill-[#DAD9D9]"
                  d="M172.41,96.88c0,13.62-8.25,25.23-19.83,29.67l6.58,11.84l-9.73,13l9.73,12.71l-17.03,23.05v-25.9v-32.77
           v-26.87c4.02,0,7.28-3.41,7.28-7.6c0-4.2-3.26-7.61-7.28-7.61V65.28C158.86,65.28,172.41,79.43,172.41,96.88z"
                />
                <path
                  class="st2 dark:fill-[#DAD9D9]"
                  d="M120.24,131.43c-9.75-8-16.3-20.3-17.2-34.27H50.8c-10.96,0-19.84,9.01-19.84,20.13v25.17
           c0,5.56,4.44,10.07,9.92,10.07h69.44c5.48,0,9.92-4.51,9.92-10.07V131.43z"
                />
                <path
                  class="st3 dark:fill-white"
                  d="M73.16,91.13c-2.42-0.46-4.82-0.89-7.11-1.86C57.4,85.64,52.36,78.95,50.73,69.5
           c-1.12-6.47-0.59-12.87,2.03-18.92c3.72-8.6,10.39-13.26,19.15-14.84c5.24-0.94,10.46-0.73,15.5,1.15
           c7.59,2.82,12.68,8.26,15.03,16.24c2.38,8.05,2.03,16.1-1.56,23.72c-3.72,7.96-10.21,12.23-18.42,13.9
           c-0.68,0.14-1.37,0.27-2.05,0.41C78,91.13,75.58,91.13,73.16,91.13z"
                />
              </g>
            </g>
          </g>
        </svg>
        Passkeys
      </h2>

      <p class="text-lg dark:text-white md:text-xl">
        Passkeys can be created and saved on your devices, like your phone or
        laptop, or on security keys.
      </p>
      <p class="text-gray-500 dark:text-gray-400">
        With passkeys on your devices, you donâ€™t need to remember complex
        passwords. Passkeys are encrypted digital keys you create using your
        fingerprint, face, or screen lock. Most passkeys are saved to your
        password manager, so you can sign in on other devices.
      </p>
      <div
        *ngIf="isPasskeysSupportedByBrowser"
        class="flex items-center rounded-lg border-[1px] border-blue-300 bg-blue-50 p-2.5 text-sm text-blue-800 dark:border-blue-800 dark:bg-slate-800 dark:text-blue-400"
        role="alert"
      >
        <svg
          class="me-3 inline h-4 w-4 flex-shrink-0"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          fill="currentColor"
          viewBox="0 0 20 20"
        >
          <path
            d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"
          />
        </svg>
        <span class="sr-only">Info</span>
        <div>
          Only passkeys that support PRF (Pseudorandom Function) can be added,
          as we use it for encryption key generation.
        </div>
      </div>
      <div
        *ngIf="isPasskeysSupportedByBrowser"
        class="flex items-center rounded-lg border-[1px] border-blue-300 bg-blue-50 p-2.5 text-sm text-blue-800 dark:border-blue-800 dark:bg-slate-800 dark:text-blue-400"
        role="alert"
      >
        <svg
          class="me-3 inline h-4 w-4 flex-shrink-0"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          fill="currentColor"
          viewBox="0 0 20 20"
        >
          <path
            d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"
          />
        </svg>
        <span class="sr-only">Info</span>
        <div>Passkeys bypass the need for two-factor authentication (2FA).</div>
      </div>
      <div
        *ngIf="!isPasskeysSupportedByBrowser"
        class="flex items-center rounded-lg border-[1px] border-yellow-300 bg-yellow-50 p-3 text-sm text-yellow-800 dark:border-yellow-800 dark:bg-slate-800 dark:text-yellow-300"
        role="alert"
      >
        <svg
          class="me-3 inline h-4 w-4 flex-shrink-0"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          fill="currentColor"
          viewBox="0 0 20 20"
        >
          <path
            d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"
          />
        </svg>
        <span class="sr-only">Info</span>
        <div>
          You can't create a passkey because your current browser does not
          support passkeys.
        </div>
      </div>
      <button
        *ngIf="isPasskeysSupportedByBrowser"
        (click)="registerPasskey()"
        class="w-fit rounded-md bg-slate-900 px-3 py-2 font-bold text-white hover:bg-black/80 dark:bg-sky-500 dark:hover:bg-sky-500/80"
      >
        Create a passkey
      </button>
      <fa-icon
        *ngIf="isPasskeyCredentialsLoading"
        class="m-auto text-slate-900 dark:text-sky-500"
        [icon]="spinnerIcon"
        [spin]="true"
        size="2xl"
      >
      </fa-icon>
      <div
        *ngIf="!isPasskeyCredentialsLoading"
        class="flex flex-col justify-center gap-3"
      >
        <div
          *ngFor="let credential of userPasskeyCredentials; let i = index"
          class="rounded-lg p-6 shadow dark:bg-slate-700"
        >
          <div class="mb-4 flex items-center justify-between">
            <div class="flex items-center justify-center gap-2">
              <img
                *ngIf="passkeyProviderDetails[credential.aaGuid]"
                [src]="passkeyProviderDetails[credential.aaGuid].icon_light"
                alt="Passkey Provider Icon"
                class="block h-8 w-8 dark:hidden"
              />
              <img
                *ngIf="passkeyProviderDetails[credential.aaGuid]"
                [src]="passkeyProviderDetails[credential.aaGuid].icon_dark"
                alt="Passkey Provider Icon"
                class="hidden h-8 w-8 dark:block"
              />
              <h2 class="text-lg font-medium text-gray-900 dark:text-white">
                {{ credential.nickname }}
              </h2>
            </div>
            <button
              (click)="deletePasskeyCredential(credential.descriptor.id, i)"
              class="text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"
            >
              Remove
            </button>
          </div>
          <p class="text-sm text-gray-500 dark:text-gray-400">
            Saved with
            {{ passkeyProviderDetails[credential.aaGuid]?.name || "Unknown" }}
            on
            {{ credential.device }}
            on
            {{ formatDateString(credential.createdAt) }}
          </p>
          <div class="mt-4">
            <p class="text-sm font-medium text-gray-700 dark:text-gray-300">
              Last used
            </p>
            <p class="mt-2 text-sm text-gray-600 dark:text-gray-400">
              {{ formatDateString(credential.lastUsedAt) }}
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section>
  <div
    class="flex items-center justify-center pb-10 sm:px-6 sm:pb-16 lg:px-8 lg:pb-24"
  >
    <div class="flex w-3/4 flex-col justify-center gap-5">
      <h2 class="text-2xl font-bold leading-tight dark:text-white">
        Two-Step Login
      </h2>
      <fa-icon
        *ngIf="!twoFactorProvidersEnabledStatus"
        class="m-auto text-slate-900 dark:text-sky-500"
        [icon]="spinnerIcon"
        [spin]="true"
        size="2xl"
      >
      </fa-icon>
      <div
        *ngIf="twoFactorProvidersEnabledStatus"
        class="flex w-full items-center justify-between gap-4 rounded-md border border-gray-300 bg-transparent px-3 py-2 focus:outline-none focus:ring-1 focus:ring-gray-400 focus:ring-offset-1 disabled:opacity-50"
      >
        <div class="flex items-center justify-center">
          <div class="dark:text-white">Authenticator App</div>
          <div
            *ngIf="twoFactorProvidersEnabledStatus.authenticatorAppEnabled"
            class="flex items-center justify-center px-2 py-2.5"
          >
            <fa-icon class="text-green-500" [icon]="checkIcon" size="xl">
            </fa-icon>
          </div>
        </div>
        <button
          type="button"
          (click)="manageAuthenticatorAppSetup()"
          class="cursor-not-allowed rounded-md bg-slate-900 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-black/80 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-black dark:bg-sky-500 dark:hover:bg-sky-500/80"
        >
          Manage
        </button>
      </div>
    </div>
  </div>
</section>
